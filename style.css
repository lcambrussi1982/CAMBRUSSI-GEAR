:root{
  --ink:#e8f0ff; --accent:#ff2d2d; --bgA:#0d1736; --bgB:#070b18;
  --panel:#101527cc; --panelBorder:#ffffff2a;
  --fontGame:'Press Start 2P', system-ui, sans-serif;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:linear-gradient(var(--bgA),var(--bgB));
  color:var(--ink);
  font:500 14px/1.4 system-ui, Segoe UI, Roboto, Ubuntu, Arial;
  touch-action:none;
  overscroll-behavior:none;
}

canvas{
  display:block;
  width:100svw;
  height:100svh;
  image-rendering:pixelated;
  image-rendering:crisp-edges;
  z-index:1;
}

/* HUD */
.hud{
  position:fixed; inset:auto 0 0 0;
  display:flex; gap:.5rem; justify-content:center;
  padding:.4rem 0;
  pointer-events:none; z-index:5;
}
.hud .tag{
  font-family:var(--fontGame);
  font-size:11px;
  background:#ffffff1c;
  border:1px solid #ffffff30;
  border-radius:.5rem;
  padding:.3rem .45rem;
}

/* Overlays */
.overlay{ position:fixed; inset:0; display:grid; place-items:center; background:rgba(3,6,12,0.6); z-index:8 }
.overlay.hidden{ display:none }
.panel{
  width:min(520px, 92vw);
  background:var(--panel); border:1px solid var(--panelBorder);
  border-radius:14px; padding:20px; color:#eef3ff;
  box-shadow:0 10px 40px #0008;
}
.panel h1{ font-family:var(--fontGame); font-size:clamp(18px,7vw,28px); margin:0 0 10px; color:var(--accent); text-align:center }
.panel .brand{ text-align:center; opacity:.85; margin-top:-4px; margin-bottom:12px }
.panel .opts{ display:grid; gap:10px; margin-top:10px }
.panel .opts button{
  font-family:var(--fontGame); font-size:12px; padding:12px; border-radius:10px;
  background:#ffffff14; border:1px solid #ffffff2c; color:#fff; cursor:pointer;
  -webkit-tap-highlight-color: rgba(0,0,0,0);
}
.panel .opts input{
  font-family:var(--fontGame); font-size:12px; padding:10px; border-radius:10px;
  background:#0d1022; border:1px solid #ffffff2c; color:#fff;
}
.panel .board{ margin-top:14px }
.panel .board h2{ font:700 12px var(--fontGame); margin:0 0 8px }
.panel .board ol{ margin:0; padding-left:20px; }

.panel.small{ width:min(420px, 92vw) }

/* Splash (2 giros + 2s hold + fade) */
.splash{
  position:fixed; inset:0;
  display:grid; place-items:center;
  background:radial-gradient(120% 120% at 50% 50%, var(--bgA) 0%, var(--bgB) 70%);
  z-index:20;
}
.spinWrap{perspective:1000px; display:grid; gap:10px; place-items:center}
.spinTxt{
  font:900 clamp(18px,8vw,48px)/1 var(--fontGame);
  color:var(--accent);
  text-transform:uppercase;
  text-shadow:0 2px 0 #000a,0 0 18px #ff2d2d66;
  transform-style:preserve-3d;
  animation:spin2 1.8s ease-in-out 1 both; /* 2 giros e pára */
}
.spinTxt.hold{ animation: none } /* estado parado por 2s */
.spinTxt.fadeText{ animation: textfade .7s ease forwards }
.hint{font-family:var(--fontGame);font-size:10px;opacity:.8}

@keyframes spin2{ 0%{transform:rotateY(0)} 100%{transform:rotateY(720deg)} }
@keyframes textfade{ to{ opacity:0; transform:translateY(-6px) } }

.splash.fade{animation:fadeout .7s ease forwards}
@keyframes fadeout{to{opacity:0;visibility:hidden}}

/* Reduce motion */
@media (prefers-reduced-motion: reduce){
  .spinTxt{ animation: none }
}

/* === Controles Mobile (grandes) === */
.controls{
  position:fixed; inset:0; z-index:6;
  display:grid;
  grid-template-columns:1fr 1fr;
  grid-template-rows:1fr 1fr;
  pointer-events:none;
  padding:1.2rem;
}
.controls .btn{
  pointer-events:auto;
  border:none; outline:none;
  background:radial-gradient(closest-side,#0b0e22,#070a18);
  border:2px solid #2b335f;
  box-shadow:0 6px 18px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.06);
  border-radius:16px;
  min-height:80px;
  touch-action:manipulation;
  opacity:0.94;
}
.controls .btn:active{ transform:translateY(1px); opacity:1; }
.controls .left{ grid-column:1; grid-row:1/span 2; margin-right:.6rem }
.controls .right{ grid-column:2; grid-row:1/span 2; margin-left:.6rem }
.controls .brake{ grid-column:1; grid-row:2; margin-right:.6rem; background:#351313; border-color:#6a2a2a }
.controls .accel{ grid-column:2; grid-row:2; margin-left:.6rem; background:#13351a; border-color:#2a6a3d }

.controls .left::before, .controls .right::before, .controls .accel::before, .controls .brake::before{
  content:""; display:block; margin:auto; width:0; height:0; border-style:solid;
}
.controls .left::before { border-width:20px 26px 20px 0; border-color:transparent #bcdcff transparent transparent; margin-top:26px }
.controls .right::before{ border-width:20px 0 20px 26px; border-color:transparent transparent transparent #bcdcff; margin-top:26px }
.controls .accel::before{ content:""; width:56px; height:16px; background:#b7ffb7; border-radius:9px; margin-top:28px }
.controls .brake::before{ content:""; width:56px; height:16px; background:#ffb7b7; border-radius:9px; margin-top:28px }

@media (min-width:900px){
  .controls{ display:none } /* só mobile */
}

/* Tap-to-start helper */
.tapStart{
  position:fixed; left:0; right:0; bottom:14vh; text-align:center; z-index:7;
  font-family:var(--fontGame); font-size:12px; letter-spacing:1px;
  color:#eaf2ff; text-shadow:0 2px 0 #0008;
  opacity:.8; pointer-events:none;
}
.hiddenTap{ display:none }
